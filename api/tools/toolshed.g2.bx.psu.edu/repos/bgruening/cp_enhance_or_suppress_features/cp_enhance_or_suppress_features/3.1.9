{"model_class": "Tool", "id": "toolshed.g2.bx.psu.edu/repos/bgruening/cp_enhance_or_suppress_features/cp_enhance_or_suppress_features/3.1.9", "name": "EnhanceOrSuppressFeatures", "version": "3.1.9", "description": "to improve subsequent identification of objects", "labels": [], "edam_operations": [], "edam_topics": [], "hidden": "", "is_workflow_compatible": true, "xrefs": [{"value": "CellProfiler", "reftype": "bio.tools"}], "tool_shed_repository": {"name": "cp_enhance_or_suppress_features", "owner": "bgruening", "changeset_revision": "f2ed92b011a9", "tool_shed": "toolshed.g2.bx.psu.edu"}, "inputs": [{"model_class": "DataToolParameter", "name": "input_pipeline", "argument": null, "type": "data", "label": "Select the input CellProfiler pipeline", "help": "", "refresh_on_change": true, "optional": false, "hidden": false, "is_dynamic": false, "value": null, "extensions": ["data"], "edam": {"edam_formats": ["format_1915"], "edam_data": ["data_0006"]}, "multiple": false, "options": {"dce": [], "ldda": [], "hda": [], "hdca": []}, "tag": null}, {"model_class": "TextToolParameter", "name": "input_image", "argument": null, "type": "text", "label": "Enter the name of the input image", "help": "", "refresh_on_change": false, "optional": true, "hidden": false, "is_dynamic": false, "value": null, "area": false, "datalist": []}, {"model_class": "TextToolParameter", "name": "name_output_image", "argument": null, "type": "text", "label": "Enter a name for the resulting image", "help": "", "refresh_on_change": false, "optional": true, "hidden": false, "is_dynamic": false, "value": null, "area": false, "datalist": []}, {"model_class": "Conditional", "name": "con_enhance_suppress", "type": "conditional", "cases": [{"model_class": "ConditionalWhen", "value": "Enhance", "inputs": [{"model_class": "Conditional", "name": "con_feature_type", "type": "conditional", "cases": [{"model_class": "ConditionalWhen", "value": "Speckles", "inputs": [{"model_class": "IntegerToolParameter", "name": "speckles_feature_size", "argument": null, "type": "integer", "label": "Feature size", "help": "Enter the diameter of the largest speckle, the width of the circle, or the width of the neurites to be enhanced or suppressed, which will be used to calculate an appropriate filter size.", "refresh_on_change": false, "min": null, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "10", "area": false, "datalist": []}, {"model_class": "SelectToolParameter", "name": "speed_accuracy", "argument": null, "type": "select", "label": "Speed and accuracy", "help": "Speckles can use a fast or slow algorithm to find speckles.                        <br> - Fast: Select this option for speckles that have a large radius (greater than 10 pixels) and need not be exactly circular.                        <br> - Slow: Use for speckles of small radius.", "refresh_on_change": false, "optional": false, "hidden": false, "is_dynamic": false, "value": "Fast", "options": [["Fast", "Fast", false], ["Slow", "Slow", false]], "display": null, "multiple": false, "textable": false}]}, {"model_class": "ConditionalWhen", "value": "Neurites", "inputs": [{"model_class": "Conditional", "name": "con_feature_neurites", "type": "conditional", "cases": [{"model_class": "ConditionalWhen", "value": "Tubeness", "inputs": [{"model_class": "FloatToolParameter", "name": "tube_smoothing_scale", "argument": null, "type": "float", "label": "Smoothing scale", "help": "The Tubeness option uses this scale as the sigma of the Gaussian used to smooth the image prior to gradient detection.", "refresh_on_change": false, "min": 0.0, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "2.0", "area": false, "datalist": []}]}, {"model_class": "ConditionalWhen", "value": "Line structures", "inputs": [{"model_class": "IntegerToolParameter", "name": "line_structures_feature_size", "argument": null, "type": "integer", "label": "Feature size", "help": "Enter the diameter of the largest speckle, the width of the circle, or the width of the neurites to be enhanced or suppressed, which will be used to calculate an appropriate filter size.", "refresh_on_change": false, "min": null, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "10", "area": false, "datalist": []}]}], "test_param": {"model_class": "SelectToolParameter", "name": "enhancement_method", "argument": null, "type": "select", "label": "Enhancement method", "help": "Two methods can be used to enhance neurites:                            <br> - Tubeness: This method is an adaptation of the method used by the ImageJ Tubeness plugin. The image is smoothed with a Gaussian. The Hessian is then computed at every point to measure the intensity gradient and the eigenvalues of the Hessian are computed to determine the magnitude of the intensity. The absolute maximum of the two eigenvalues gives a measure of the ratio of the intensity of the gradient in the direction of its most rapid descent versus in the orthogonal direction. The output image is the absolute magnitude of the highest eigenvalue if that eigenvalue is negative (white neurite on dark background), otherwise, zero.                            <br> - Line structures: The module takes the difference of the white and black tophat filters (a white tophat filtering is the image minus the morphological grayscale opening of the image; a black tophat filtering is the morphological grayscale closing of the image minus the image). The effect is to enhance lines whose width is the feature size.", "refresh_on_change": true, "optional": false, "hidden": false, "is_dynamic": false, "value": "Tubeness", "options": [["Tubeness", "Tubeness", false], ["Line structures", "Line structures", false]], "display": null, "multiple": false, "textable": false}}]}, {"model_class": "ConditionalWhen", "value": "Dark holes", "inputs": [{"model_class": "IntegerToolParameter", "name": "min_hole_size", "argument": null, "type": "integer", "label": "Minimum hole size", "help": "", "refresh_on_change": false, "min": 0, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "1", "area": false, "datalist": []}, {"model_class": "IntegerToolParameter", "name": "max_hole_size", "argument": null, "type": "integer", "label": "Maximum hole size", "help": "", "refresh_on_change": false, "min": 0, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "10", "area": false, "datalist": []}]}, {"model_class": "ConditionalWhen", "value": "Circles", "inputs": [{"model_class": "IntegerToolParameter", "name": "circle_feature_size", "argument": null, "type": "integer", "label": "Feature size", "help": "Enter the diameter of the largest speckle, the width of the circle, or the width of the neurites to be enhanced or suppressed, which will be used to calculate an appropriate filter size.", "refresh_on_change": false, "min": null, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "10", "area": false, "datalist": []}]}, {"model_class": "ConditionalWhen", "value": "Texture", "inputs": [{"model_class": "FloatToolParameter", "name": "texture_smoothing_scale", "argument": null, "type": "float", "label": "Smoothing scale", "help": "This is roughly the scale of the texture features, in pixels. The algorithm uses the smoothing value entered as the sigma of the Gaussian used to weight nearby pixels by distance in the variance calculation.", "refresh_on_change": false, "min": 0.0, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "2.0", "area": false, "datalist": []}]}, {"model_class": "ConditionalWhen", "value": "DIC", "inputs": [{"model_class": "FloatToolParameter", "name": "dic_smoothing_scale", "argument": null, "type": "float", "label": "Smoothing scale", "help": "Specifies the amount of smoothing of the image in the direction parallel to the shear axis of the image. The line integration method will leave streaks in the image without smoothing as it encounters noisy pixels during the course of the integration. The smoothing takes contributions from nearby pixels, which decreases the noise but smooths the resulting image. Increase the smoothing to eliminate streakiness and decrease the smoothing to sharpen the image.", "refresh_on_change": false, "min": 0.0, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "2.0", "area": false, "datalist": []}, {"model_class": "FloatToolParameter", "name": "dic_shear_angle", "argument": null, "type": "float", "label": "Shear angle", "help": "The shear angle is the direction of constant value for the shadows and highlights in a DIC image. The gradients in a DIC image run in the direction perpendicular to the shear angle.", "refresh_on_change": false, "min": 0.0, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "0.0", "area": false, "datalist": []}, {"model_class": "FloatToolParameter", "name": "dic_decay", "argument": null, "type": "float", "label": "Decay", "help": "The decay setting applies an exponential decay during the process of integration by multiplying the accumulated sum by the decay at each step. This lets the integration recover from accumulated error during the course of the integration, but it also results in diminished intensities in the middle of large objects. Set the decay to a large value, on the order of 1 - 1/diameter of your objects if the intensities decrease toward the middle. Set the decay to a small value if there appears to be a bias in the integration direction.", "refresh_on_change": false, "min": 0.0, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "0.95", "area": false, "datalist": []}]}], "test_param": {"model_class": "SelectToolParameter", "name": "feature_type", "argument": null, "type": "select", "label": "Feature type", "help": "- Speckles: A speckle is an area of enhanced intensity relative to its immediate neighborhood. This option enhances speckles using a white tophat filter, which is the image minus the morphological grayscale opening of the image. The opening operation first suppresses the speckles by applying a grayscale erosion to reduce everything within a given radius to the lowest value within that radius, then uses a grayscale dilation to restore objects larger than the radius to an approximation of their former shape. The white tophat filter enhances speckles by subtracting the effects of opening from the original image.                                <br>- Neurites: Neurites are taken to be long, thin features of enhanced intensity. Choose this option to enhance the intensity of the neurites using the Line structures or Tubeness methods described in a later setting.                                <br>- Dark holes: This option uses morphological reconstruction (the rolling-ball algorithm) to identify dark holes within brighter areas, or brighter ring shapes. The image is inverted so that the dark holes turn into bright peaks. The image is successively eroded and the eroded image is reconstructed at each step, resulting in an image that is missing the peaks. Finally, the reconstructed image is subtracted from the previous reconstructed image. This leaves circular bright spots with a radius equal to the number of iterations performed.                                <br>- Circles: This option calculates the circular Hough transform of the image at the diameter given by the feature size. The Hough transform will have the highest intensity at points that are centered within a ring of high intensity pixels where the ring diameter is the feature size. You may want to use the EnhanceEdges module to find the edges of your circular object and then process the output by enhancing circles. You can use IdentifyPrimaryObjects to find the circle centers and then use these centers as seeds in IdentifySecondaryObjects to find whole, circular objects using a watershed.                                <br>- Texture: This option produces an image whose intensity is the variance among nearby pixels. The method weights pixel contributions by distance using a Gaussian to calculate the weighting. You can use this method to separate foreground from background if the foreground is textured and the background is not.                                <br>- DIC: This method recovers the optical density of a DIC image by integrating in a direction perpendicular to the shear direction of the image.", "refresh_on_change": true, "optional": false, "hidden": false, "is_dynamic": false, "value": "Speckles", "options": [["Speckles", "Speckles", false], ["Neurites", "Neurites", false], ["Dark holes", "Dark holes", false], ["Circles", "Circles", false], ["Texture", "Texture", false], ["DIC", "DIC", false]], "display": null, "multiple": false, "textable": false}}]}, {"model_class": "ConditionalWhen", "value": "Suppress", "inputs": [{"model_class": "IntegerToolParameter", "name": "feature_size", "argument": null, "type": "integer", "label": "Feature size", "help": "Enter the diameter of the largest speckle, the width of the circle, or the width of the neurites to be enhanced or suppressed, which will be used to calculate an appropriate filter size.", "refresh_on_change": false, "min": null, "max": null, "optional": false, "hidden": false, "is_dynamic": false, "value": "10", "area": false, "datalist": []}]}], "test_param": {"model_class": "SelectToolParameter", "name": "select_operation", "argument": null, "type": "select", "label": "Select the operation", "help": "Enhance produces an image whose intensity is largely composed of the features of interest and Supress produces an image with the features largely removed.", "refresh_on_change": true, "optional": false, "hidden": false, "is_dynamic": false, "value": "Enhance", "options": [["Enhance", "Enhance", false], ["Suppress", "Suppress", false]], "display": null, "multiple": false, "textable": false}}], "outputs": [{"model_class": "ToolOutput", "name": "output_pipeline", "format": "txt", "label": "", "hidden": false, "output_type": "data", "format_source": null, "default_identifier_source": "None", "metadata_source": "", "parent": null, "count": 1, "from_work_dir": "output.cppipe", "edam_format": "format_2330", "edam_data": "data_0006", "discover_datasets": [{"discover_via": "pattern", "dbkey": "__input__", "format": null, "visible": false, "assign_primary_output": false, "directory": null, "recurse": false, "match_relative_path": false, "sort_key": "filename", "sort_comp": "lexical", "pattern": "primary_DATASET_ID_(?P<designation>[^_]+)_(?P<visible>[^_]+)_(?P<ext>[^_]+)(_(?P<dbkey>[^_]+))?", "sort_by": "filename"}]}], "panel_section_id": "imaging", "panel_section_name": "Imaging", "form_style": "regular"}